# Спецификация: API Регистрации Пользователей v1

## Эндпоинт

`POST /api/v1/users/register`

## Описание

Создает новую учетную запись. Публичный метод.

## Бизнес-логика (Business Rules)

1. **Уникальность:** Email должен быть уникальным в системе.
2. **2FA Flow:** После валидации данных **система отправляет SMS с OTP кодом** для активации аккаунта.
3. **Безопасность пароля (NIST Guidelines):**
    - Минимум 8 символов.
    - Должен содержать цифры и спецсимволы.
    - **ЗАПРЕЩЕНО:** Использовать в пароле части своего **email**, **имени** или **фамилии** (защита от социальной инженерии).
4. **Локализация:** Поддержка UTF-8 имен.

## Тело запроса (JSON Body)

| Поле        | Тип | Обязательно | Ограничения | Описание                       |
|-------------|---|---|---|--------------------------------|
| `email`     | string | Да | Valid email | Логин пользователя.            |
| `password`  | string | Да | Мин. 8 символов | См. правила безопасности выше. |
| `full_name` | string | Да | Макс. 100 симв. | ФИО пользователя.              |

## Пример запроса (Example Payload)
>
> **Warning:** Используйте этот пример как эталон для автотестов.

```json
{
  "email": "alex.kid@example.com",
  "password": "Alex_2026!",
  "full_name": "Alex Kid",
  "nickname": "shooter_99"
}
```

## Исключено из скоупа тестирования (Test Scope Reduction)

Следующие аспекты **не тестируются** на уровне этого эндпоинта:

| Сценарий | Владелец | Что тестируем вместо |
|---|---|---|
| **Валидация форматов** (`email`, `phone`, `full_name`): Regex, спецсимволы | Middleware (Zod/Pydantic) | Только наличие поля: отсутствие → 400 |
| **Уникальность (Race Condition)**: параллельные запросы с одним email/phone | Unique Index в БД | Только 409 при конфликте (последовательные запросы) |
| **Логика PII (подстроки, токены)**: комбинации "имя в пароле" | Unit-тесты shared-library | Только базовый happy/sad path на уровне API |
| **Гарантия доставки SMS**: факт получения OTP пользователем | Notification Service | Только 201 при успешной постановке в очередь; 503 при недоступности шлюза |
| **Граничные значения длин** (напр. 101 символ в `full_name`) | Уровень БД | — |
